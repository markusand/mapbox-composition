{"version":3,"file":"index.esm.js","sources":["../src/map.js","../node_modules/style-inject/dist/style-inject.es.js","../src/controls/StylesControl.js","../src/terrain.js","../src/controls/TerrainControl.js","../src/controls/index.js","../src/layer.js","../src/events/events.source.js","../src/events/events.layer.js","../src/geojson.js","../src/marker.js","../src/events/events.marker.js","../src/popup.js","../src/events/events.popup.js"],"sourcesContent":["import { Map } from 'mapbox-gl';\n\nexport default async function useMap(container, options = {}) {\n\tconst map = new Map({ container, ...options });\n\tawait map.once('load');\n\treturn map;\n}\n","function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","import './styles.control.css';\n\nexport default class StylesControl {\n\tconstructor({ styles }) {\n\t\tthis._styles = styles;\n\t\tthis._active = null;\n\t\tthis._setActive = this._setActive.bind(this);\n\t}\n\n\tonAdd(map) {\n\t\tthis._map = map;\n\n\t\tthis._container = document.createElement('div');\n\t\tthis._container.classList.add('mapboxgl-ctrl', 'mapboxgl-ctrl-group', 'mapboxgl-ctrl-styles');\n\n\t\tthis._buttons = this._styles.map(style => {\n\t\t\tconst button = document.createElement('button');\n\t\t\tif (style.img) {\n\t\t\t\tconst thumbnail = document.createElement('img');\n\t\t\t\tthumbnail.src = style.img;\n\t\t\t\tbutton.appendChild(thumbnail);\n\t\t\t} else {\n\t\t\t\tconst label = document.createElement('span');\n\t\t\t\tlabel.textContent = style.label;\n\t\t\t\tbutton.appendChild(label);\n\t\t\t}\n\t\t\tbutton.addEventListener('click', () => {\n\t\t\t\tif (this._active !== style.name) this._map.setStyle(style.url);\n\t\t\t});\n\t\t\tthis._container.appendChild(button);\n\t\t\treturn button;\n\t\t});\n\n\t\tthis._map.on('style.load', this._setActive);\n\n\t\tthis._setActive();\n\n\t\treturn this._container;\n\t}\n\n\t_setActive() {\n\t\tthis._buttons.forEach(button => button.classList.remove('is-active'));\n\t\tconst { name } = this._map.getStyle();\n\t\tconst index = this._styles.findIndex(style => style.name === name);\n\t\tif (index >= 0) this._buttons[index].classList.add('is-active');\n\t\tthis._active = name;\n\t}\n\n\tonRemove() {\n\t\tthis._container.parentNode.removeChild(this._container);\n\t\tthis._map.off('style.load', this._setActive);\n\t\tthis._map = undefined;\n\t}\n}\n","const TERRAIN = {\n\ttype: 'raster-dem',\n\turl: 'mapbox://mapbox.mapbox-terrain-dem-v1',\n\ttileSize: 512,\n};\n\nconst SKY = {\n\t'sky-opacity': ['interpolate', ['linear'], ['zoom'], 0, 0, 8, 1],\n\t'sky-type': 'atmosphere',\n\t'sky-atmosphere-sun-intensity': 5,\n};\n\nexport default function useTerrain(map, options = {}) {\n\tconst { sky = SKY, ...rest } = options;\n\n\tconst extrude = ({ exaggeration = 1.5, pitch = 45 }) => {\n\t\tmap.addSource('mapboxgl-dem', { ...TERRAIN, ...rest });\n\t\tmap.setTerrain({ source: 'mapboxgl-dem', exaggeration });\n\t\tmap.easeTo({ pitch });\n\t\tif (sky && !map.getLayer('mapboxgl-sky')) {\n\t\t\tmap.addLayer({ id: 'mapboxgl-sky', type: 'sky', paint: sky });\n\t\t}\n\t};\n\n\tconst flatten = () => {\n\t\tmap.setTerrain();\n\t\tmap.easeTo({ pitch: 0 });\n\t\tif (map.getSource('mapboxgl-dem')) map.removeSource('mapboxgl-dem');\n\t\tif (map.getLayer('mapboxgl-sky')) map.removeLayer('mapboxgl-sky');\n\t};\n\n\tconst isExtruded = () => !!map.getTerrain();\n\n\treturn { extrude, flatten, isExtruded };\n}\n","import useTerrain from '../terrain';\nimport './terrain.control.css';\n\nexport default class TerrainControl {\n\tconstructor(options = {}) {\n\t\tthis._options = options;\n\t}\n\n\tonAdd(map) {\n\t\tconst { extrudeOnInit = false, exaggeration, pitch, ...options } = this._options;\n\t\tconst terrain = useTerrain(map, options);\n\n\t\tthis._container = document.createElement('div');\n\t\tthis._container.classList.add('mapboxgl-ctrl', 'mapboxgl-ctrl-group');\n\n\t\tconst button = document.createElement('button');\n\t\tbutton.classList.add('mapboxgl-ctrl-terrain');\n\t\tthis._container.appendChild(button);\n\n\t\tconst extrude = doExtrude => {\n\t\t\tif (doExtrude) terrain.extrude({ exaggeration, pitch });\n\t\t\telse terrain.flatten();\n\t\t\tbutton.classList.toggle('mapboxgl-ctrl-terrain-3d', doExtrude);\n\t\t};\n\n\t\tbutton.addEventListener('click', () => extrude(!terrain.isExtruded()));\n\n\t\t// Reload terrain extrusion state on map style change\n\t\tmap.on('style.load', () => extrude(terrain.isExtruded()));\n\n\t\textrude(extrudeOnInit);\n\n\t\treturn this._container;\n\t}\n\n\tonRemove() {\n\t\tthis._container.parentNode.removeChild(this._container);\n\t}\n}\n","import { NavigationControl, ScaleControl, GeolocateControl, AttributionControl, FullscreenControl } from 'mapbox-gl';\nimport StylesControl from './StylesControl';\nimport TerrainControl from './TerrainControl';\n\nexport default map => {\n\tconst CONTROLS = {};\n\n\tconst addControl = (name, position, control) => {\n\t\tCONTROLS[name] = control;\n\t\tmap.addControl(control, position);\n\t};\n\n\tconst removeControl = name => {\n\t\tif (CONTROLS[name]) {\n\t\t\tmap.removeControl(CONTROLS[name]);\n\t\t\tdelete CONTROLS[name];\n\t\t}\n\t};\n\n\tconst addNavigation = ({ position = 'top-right', ...config } = {}) => {\n\t\taddControl('navigation', position, new NavigationControl(config));\n\t};\n\n\tconst addScale = ({ position = 'bottom-left', ...config } = {}) => {\n\t\taddControl('scale', position, new ScaleControl(config));\n\t};\n\n\tconst addGeolocate = ({ position = 'top-right', ...config } = {}) => {\n\t\taddControl('geolocate', position, new GeolocateControl(config));\n\t};\n\n\tconst addAttribution = ({ position = 'bottom-right', ...config } = {}) => {\n\t\taddControl('attribution', position, new AttributionControl(config));\n\t};\n\n\tconst addFullscreen = ({ position = 'top-right', ...config } = {}) => {\n\t\taddControl('fullscreen', position, new FullscreenControl(config));\n\t};\n\n\tconst addStyles = ({ position = 'top-right', ...config } = {}) => {\n\t\taddControl('styles', position, new StylesControl(config));\n\t};\n\n\tconst addTerrain = ({ position = 'top-right', ...config } = {}) => {\n\t\taddControl('terrain', position, new TerrainControl(config));\n\t};\n\n\tconst removeNavigation = () => removeControl('navigation');\n\tconst removeScale = () => removeControl('scale');\n\tconst removeGeolocate = () => removeControl('geolocate');\n\tconst removeAttribution = () => removeControl('attribution');\n\tconst removeFullscreen = () => removeControl('fullscreen');\n\tconst removeStyles = () => removeControl('styles');\n\tconst removeTerrain = () => removeControl('terrain');\n\n\treturn {\n\t\taddControl,\n\t\tremoveControl,\n\t\taddNavigation,\n\t\taddScale,\n\t\taddGeolocate,\n\t\taddAttribution,\n\t\taddFullscreen,\n\t\taddStyles,\n\t\taddTerrain,\n\t\tremoveNavigation,\n\t\tremoveScale,\n\t\tremoveGeolocate,\n\t\tremoveAttribution,\n\t\tremoveFullscreen,\n\t\tremoveStyles,\n\t\tremoveTerrain,\n\t};\n};\n","import { useSourceEvents, useLayerEvents } from './events';\n\nconst isObject = item => !!item && item.constructor === Object;\n\nexport default function useLayer(map, options = {}) {\n\tconst { bindSourceEvents, unbindSourceEvents } = useSourceEvents(map, options.name, options);\n\tconst { bindLayerEvents, unbindLayerEvents } = useLayerEvents(map, options);\n\tconst LAYERS = [];\n\n\tconst isVisible = id => map.getLayoutProperty(id, 'visibility') === 'visible';\n\n\tconst setVisibility = (visible, layers = Object.keys(LAYERS)) => {\n\t\tconst visibility = visible ? 'visible' : 'none';\n\t\tlayers.forEach(id => {\n\t\t\tLAYERS[id].visible = visible;\n\t\t\tmap.setLayoutProperty(id, 'visibility', visibility);\n\t\t});\n\t};\n\n\tconst setFilters = (filters = [], layers = Object.keys(LAYERS)) => {\n\t\tconst all = isObject(filters) ? ['all', ...Object.values(filters).filter(Boolean)] : filters;\n\t\tlayers.forEach(id => {\n\t\t\tLAYERS[id].filter = all && all.length ? all : LAYERS[id].filter;\n\t\t\tmap.setFilter(id, LAYERS[id].filter);\n\t\t});\n\t};\n\n\tconst clearLayers = (layers = Object.keys(LAYERS)) => {\n\t\tlayers.forEach(id => {\n\t\t\tunbindLayerEvents(id);\n\t\t\tif (map.getLayer(id)) map.removeLayer(id);\n\t\t\tif (id in LAYERS) delete LAYERS[id];\n\t\t});\n\t};\n\n\tconst addLayers = (layers = []) => {\n\t\tconst { name: sourceName, persist = true } = options;\n\t\tlayers.forEach(({ name, visible = true, ...params }, i) => {\n\t\t\tconst id = name || `${sourceName}--${i}`;\n\t\t\tLAYERS[id] = { name, ...params };\n\t\t\tmap.addLayer({ id, source: sourceName, ...params });\n\t\t\tsetVisibility(visible, [id]);\n\t\t\tbindLayerEvents(id);\n\t\t});\n\t\tif (persist) map.once('style.load', () => addLayers(Object.values(LAYERS)));\n\t};\n\n\tconst clearSource = () => {\n\t\tconst { name } = options;\n\t\tclearLayers();\n\t\tunbindSourceEvents();\n\t\tif (map.getSource(name)) map.removeSource(name);\n\t};\n\n\tconst setSource = source => {\n\t\tconst { name, type, persist = true } = options;\n\t\tconst key = type === 'geojson' ? 'data' : 'url';\n\t\tconst content = isObject(source) ? source : { [key]: source };\n\t\tmap.addSource(name, { type, ...content });\n\t\tbindSourceEvents();\n\t\tif (persist) map.once('style.load', () => setSource(source));\n\t};\n\n\tconst updateSource = (source, layers = options.layers) => {\n\t\tclearSource();\n\t\tsetSource(source);\n\t\taddLayers(layers);\n\t};\n\n\tsetSource(options.source);\n\taddLayers(options.layers);\n\n\treturn {\n\t\tclearLayers,\n\t\taddLayers,\n\t\tclearSource,\n\t\tsetSource,\n\t\tupdateSource,\n\t\tisVisible,\n\t\tsetVisibility,\n\t\tsetFilters,\n\t};\n}\n","export default (map, sourceId, { onError, onLoadStart, onLoadEnd }) => {\n\tlet isSourceLoading = false;\n\n\tconst sourceLoadStartHandler = event => {\n\t\tconst { sourceDataType = 'content' } = event; // Little hack here\n\t\tif (event.sourceId === sourceId && !isSourceLoading && sourceDataType === 'content') {\n\t\t\tif (onLoadStart) onLoadStart(event);\n\t\t\tisSourceLoading = true;\n\t\t}\n\t};\n\n\tconst sourceLoadEndHandler = event => {\n\t\tif (event.sourceId === sourceId && isSourceLoading && map.isSourceLoaded(sourceId)) {\n\t\t\tif (onLoadEnd) onLoadEnd(event);\n\t\t\tisSourceLoading = false;\n\t\t}\n\t};\n\n\tconst sourceErrorHandler = event => {\n\t\tif (event.sourceId === sourceId) onError(event.error);\n\t};\n\n\tconst bindSourceEvents = () => {\n\t\tif (onLoadStart || onLoadEnd) map.on('sourcedataloading', sourceLoadStartHandler);\n\t\tif (onLoadEnd) map.on('sourcedata', sourceLoadEndHandler);\n\t\tif (onError) map.on('error', sourceErrorHandler);\n\t};\n\n\tconst unbindSourceEvents = () => {\n\t\tmap.off('sourcedataloading', sourceLoadStartHandler);\n\t\tmap.off('sourcedata', sourceLoadEndHandler);\n\t\tmap.off('error', sourceErrorHandler);\n\t};\n\n\treturn { bindSourceEvents, unbindSourceEvents };\n};\n","export default (map, { onClick, onHover }) => {\n\tconst layerClickHandler = event => onClick(event);\n\tconst layerHoverHandler = event => onHover(event);\n\n\tconst bindLayerEvents = layerId => {\n\t\tif (onClick) map.on('click', layerId, layerClickHandler);\n\t\tif (onHover) {\n\t\t\tmap.on('mouseenter', layerId, layerHoverHandler);\n\t\t\tmap.on('mousemove', layerId, layerHoverHandler);\n\t\t\tmap.on('mouseleave', layerId, layerHoverHandler);\n\t\t}\n\t};\n\n\tconst unbindLayerEvents = layerId => {\n\t\tmap.off('click', layerId, layerClickHandler);\n\t\tmap.off('mouseenter', layerId, layerHoverHandler);\n\t\tmap.off('mousemove', layerId, layerHoverHandler);\n\t\tmap.off('mouseleave', layerId, layerHoverHandler);\n\t};\n\n\treturn { bindLayerEvents, unbindLayerEvents };\n};\n","import useLayer from './layer';\n\nexport default function useGeoJSON(map, options = {}) {\n\t// Adapt to GeoJSON source format\n\tconst geoJSON = useLayer(map, {\n\t\t...options,\n\t\ttype: 'geojson',\n\t\tsource: { data: options.source },\n\t});\n\n\t// Override. GeoJSON can be updated by setting new data\n\tconst updateSource = data => {\n\t\tconst source = map.getSource(options.name);\n\t\tif (source) source.setData(data);\n\t\telse geoJSON.updateSource({ data });\n\t};\n\n\treturn { ...geoJSON, updateSource };\n}\n","import { Marker } from 'mapbox-gl';\nimport { useMarkerEvents } from './events';\n\nexport default function useMarker(map, options = {}) {\n\tconst { coordinates, popup, ...rest } = options;\n\tconst { bindMarkerEvents } = useMarkerEvents(options);\n\n\tconst marker = new Marker({ ...rest });\n\tlet markerPopup;\n\n\tconst setLocation = coords => marker.setLngLat(coords).addTo(map);\n\tconst setPopup = newPopup => {\n\t\tmarkerPopup = newPopup;\n\t\tmarker.setPopup(newPopup.popup);\n\t};\n\n\t// Instantiate\n\tif (popup) setPopup(popup);\n\tsetLocation(coordinates);\n\tbindMarkerEvents(marker);\n\n\treturn {\n\t\tsetLocation,\n\t\tget marker() { return marker; },\n\t\tget popup() { return markerPopup; },\n\t\tset popup(newPopup) { setPopup(newPopup); },\n\t};\n}\n","export default ({ onDragStart, onDrag, onDragEnd }) => {\n\tconst bindMarkerEvents = marker => {\n\t\tif (onDragStart) marker.on('dragstart', onDragStart);\n\t\tif (onDrag) marker.on('drag', onDrag);\n\t\tif (onDragEnd) marker.on('dragend', onDragEnd);\n\t};\n\n\tconst unbindMarkerEvents = marker => {\n\t\tmarker.on('dragstart', onDragStart);\n\t\tmarker.on('drag', onDrag);\n\t\tmarker.on('dragend', onDragEnd);\n\t};\n\n\treturn { bindMarkerEvents, unbindMarkerEvents };\n};\n","import { Popup } from 'mapbox-gl';\nimport { usePopupEvents } from './events';\n\nconst uuid = () => Math.random().toString(36).substring(7);\n\nexport default function usePopup(...args) {\n\tconst [map, options = {}] = args.length === 1 ? [, args[0]] : args;\n\tconst { content, coordinates, name = `popup-${uuid()}`, ...rest } = options;\n\tconst { bindPopupEvents } = usePopupEvents(options);\n\n\tconst popup = new Popup(rest);\n\n\tconst setLocation = coords => popup.setLngLat(coords).addTo(map);\n\tconst setContent = newContent => popup.setHTML(newContent);\n\n\t// Instantiate\n\tif (coordinates) setLocation(coordinates);\n\tsetContent(content || `<div id=\"${name}\"></div>`);\n\tbindPopupEvents(popup);\n\n\treturn {\n\t\tget popup() { return popup; },\n\t\tname,\n\t\tsetLocation,\n\t\tsetContent,\n\t};\n}\n","export default ({ onOpen, onClose }) => {\n\tconst bindPopupEvents = popup => {\n\t\tif (onOpen) popup.on('open', onOpen);\n\t\tif (onClose) popup.on('close', onClose);\n\t};\n\n\tconst unbindPopupEvents = popup => {\n\t\tpopup.off('open', onOpen);\n\t\tpopup.off('close', onClose);\n\t};\n\n\treturn { bindPopupEvents, unbindPopupEvents };\n};\n"],"names":["async","useMap","container","options","map","Map","once","styleInject","css","ref","insertAt","document","head","getElementsByTagName","style","createElement","type","firstChild","insertBefore","appendChild","styleSheet","cssText","createTextNode","StylesControl","constructor","styles","this","_styles","_active","_setActive","bind","onAdd","_map","_container","classList","add","_buttons","button","img","thumbnail","src","label","textContent","addEventListener","name","setStyle","url","on","forEach","remove","getStyle","index","findIndex","onRemove","parentNode","removeChild","off","undefined","TERRAIN","tileSize","SKY","useTerrain","sky","rest","extrude","exaggeration","pitch","addSource","setTerrain","source","easeTo","getLayer","addLayer","id","paint","flatten","getSource","removeSource","removeLayer","isExtruded","getTerrain","TerrainControl","_options","extrudeOnInit","terrain","doExtrude","toggle","CONTROLS","addControl","position","control","removeControl","addNavigation","config","NavigationControl","addScale","ScaleControl","addGeolocate","GeolocateControl","addAttribution","AttributionControl","addFullscreen","FullscreenControl","addStyles","addTerrain","removeNavigation","removeScale","removeGeolocate","removeAttribution","removeFullscreen","removeStyles","removeTerrain","isObject","item","Object","useLayer","bindSourceEvents","unbindSourceEvents","sourceId","onError","onLoadStart","onLoadEnd","isSourceLoading","sourceLoadStartHandler","event","sourceDataType","sourceLoadEndHandler","isSourceLoaded","sourceErrorHandler","error","useSourceEvents","bindLayerEvents","unbindLayerEvents","onClick","onHover","layerClickHandler","layerHoverHandler","layerId","useLayerEvents","LAYERS","setVisibility","visible","layers","keys","visibility","setLayoutProperty","clearLayers","addLayers","sourceName","persist","params","i","values","clearSource","setSource","key","content","updateSource","isVisible","getLayoutProperty","setFilters","filters","all","filter","Boolean","length","setFilter","useGeoJSON","geoJSON","data","setData","useMarker","coordinates","popup","bindMarkerEvents","onDragStart","onDrag","onDragEnd","marker","unbindMarkerEvents","useMarkerEvents","Marker","markerPopup","setLocation","coords","setLngLat","addTo","setPopup","newPopup","uuid","Math","random","toString","substring","usePopup","args","bindPopupEvents","onOpen","onClose","unbindPopupEvents","usePopupEvents","Popup","setContent","newContent","setHTML"],"mappings":"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"}